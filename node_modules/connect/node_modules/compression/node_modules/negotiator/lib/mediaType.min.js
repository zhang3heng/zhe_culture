module.exports=preferredMediaTypes;preferredMediaTypes.preferredMediaTypes=preferredMediaTypes;function parseAccept(a){return a.split(",").map(function(b){return parseMediaType(b.trim())}).filter(function(b){return b&&b.q>0})}function parseMediaType(e){var b=e.match(/\s*(\S+)\/([^;\s]+)\s*(?:;(.*))?/);if(!b){return null}var d=b[1],a=b[2],c=""+d+"/"+a,g={},f=1;if(b[3]){g=b[3].split(";").map(function(h){return h.trim().split("=")}).reduce(function(i,h){i[h[0]]=h[1];return i},g);if(g.q!=null){f=parseFloat(g.q);delete g.q}}return{type:d,subtype:a,params:g,q:f,full:c}}function getMediaTypePriority(a,b){return(b.filter(function(c){return specify(a,c)}).sort(function(d,c){return d.q>c.q?-1:1})[0]||{q:0}).q}function specifies(a,b){return a==="*"||a===b}function specify(b,a){var d=parseMediaType(b);if(a.params){var c=Object.keys(a.params);if(c.some(function(e){return !specifies(a.params[e],d.params[e])})){return null}}if(specifies(a.type,d.type)&&specifies(a.subtype,d.subtype)){return a}}function preferredMediaTypes(b,a){b=parseAccept(b||"");if(a){return a.map(function(c){return[c,getMediaTypePriority(c,b)]}).filter(function(c){return c[1]>0}).sort(function(d,c){return d[1]===c[1]?0:d[1]>c[1]?-1:1}).map(function(c){return c[0]})}else{return b.sort(function(d,c){return d.q<c.q?1:-1}).map(function(c){return c.full})}};