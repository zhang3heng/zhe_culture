module.exports=preferredLanguages;preferredLanguages.preferredLanguages=preferredLanguages;function parseAcceptLanguage(a){return a.split(",").map(function(b){return parseLanguage(b.trim())}).filter(function(b){return b&&b.q>0})}function parseLanguage(j){var e=j.match(/^\s*(\S+?)(?:-(\S+?))?\s*(?:;(.*))?$/);if(!e){return null}var f=e[1],h=e[2],g=f;if(h){g+="-"+h}var a=1;if(e[3]){var c=e[3].split(";");for(var d=0;d<c.length;d++){var b=c[d].split("=");if(b[0]==="q"){a=parseFloat(b[1])}}}return{prefix:f,suffix:h,q:a,full:g}}function getLanguagePriority(c,b){var a=getClosestMatch(c,b);return a?a.q:0}function getClosestMatch(d,c){var a=parseLanguage(d);var b=c.filter(function(e){return e.full===a.full});if(b.length){return b[0]}b=c.filter(function(e){return e.prefix===a.prefix&&!e.suffix});if(b.length){return b[0]}b=c.filter(function(e){return e.prefix===a.prefix});if(b.length){return b[0]}b=c.filter(function(e){return e.prefix==="*"});return b[0]}function preferredLanguages(c,a){c=parseAcceptLanguage(c||"");if(a){var b=a.map(function(d){return[d,getLanguagePriority(d,c)]}).filter(function(d){return d[1]>0}).sort(function(e,d){return e[1]===d[1]?0:e[1]>d[1]?-1:1}).map(function(d){return d[0]});return b}else{return c.sort(function(e,d){return e.q<d.q?1:-1}).map(function(d){return d.full})}};