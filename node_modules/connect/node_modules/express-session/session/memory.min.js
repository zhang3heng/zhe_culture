/*
 * Connect - session - MemoryStore
 * Copyright(c) 2010 Sencha Inc.
 * Copyright(c) 2011 TJ Holowaychuk
 * MIT Licensed
 */
var Store=require("./store");var MemoryStore=module.exports=function MemoryStore(){this.sessions={}};MemoryStore.prototype.__proto__=Store.prototype;MemoryStore.prototype.get=function(a,c){var b=this;setImmediate(function(){var d,e=b.sessions[a];if(e){e=JSON.parse(e);d="string"==typeof e.cookie.expires?new Date(e.cookie.expires):e.cookie.expires;if(!d||new Date<d){c(null,e)}else{b.destroy(a,c)}}else{c()}})};MemoryStore.prototype.set=function(a,c,d){var b=this;setImmediate(function(){b.sessions[a]=JSON.stringify(c);d&&d()})};MemoryStore.prototype.destroy=function(a,c){var b=this;setImmediate(function(){delete b.sessions[a];c&&c()})};MemoryStore.prototype.all=function(d){var b=[],e=Object.keys(this.sessions);for(var c=0,a=e.length;c<a;++c){b.push(this.sessions[e[c]])}d(null,b)};MemoryStore.prototype.clear=function(a){this.sessions={};a&&a()};MemoryStore.prototype.length=function(a){a(null,Object.keys(this.sessions).length)};