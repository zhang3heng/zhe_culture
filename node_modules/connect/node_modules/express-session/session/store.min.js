/*
 * Connect - session - Store
 * Copyright(c) 2010 Sencha Inc.
 * Copyright(c) 2011 TJ Holowaychuk
 * MIT Licensed
 */
var EventEmitter=require("events").EventEmitter,Session=require("./session"),Cookie=require("./cookie");var Store=module.exports=function Store(a){};Store.prototype.__proto__=EventEmitter.prototype;Store.prototype.regenerate=function(c,b){var a=this;this.destroy(c.sessionID,function(d){a.generate(c);b(d)})};Store.prototype.load=function(a,c){var b=this;this.get(a,function(f,d){if(f){return c(f)}if(!d){return c()}var e={sessionID:a,sessionStore:b};d=b.createSession(e,d);c(null,d)})};Store.prototype.createSession=function(c,b){var a=b.cookie.expires,d=b.cookie.originalMaxAge;b.cookie=new Cookie(b.cookie);if("string"==typeof a){b.cookie.expires=new Date(a)}b.cookie.originalMaxAge=d;c.session=new Session(c,b);return c.session};