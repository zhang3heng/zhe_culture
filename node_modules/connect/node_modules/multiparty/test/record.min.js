var http=require("http");var fs=require("fs");var connections=0;var server=http.createServer(function(c,b){var a=c.socket;console.log("Request: %s %s -> %s",c.method,c.url,a.filename);c.on("end",function(){if(c.url!=="/"){b.end(JSON.stringify({method:c.method,url:c.url,filename:a.filename,}));return}b.writeHead(200,{"content-type":"text/html"});b.end('<form action="/upload" enctype="multipart/form-data" method="post"><input type="text" name="title"><br><input type="file" name="upload" multiple="multiple"><br><input type="submit" value="Upload"></form>')})});server.on("connection",function(a){connections++;a.id=connections;a.filename="connection-"+a.id+".http";a.file=fs.createWriteStream(a.filename);a.pipe(a.file);console.log("--> %s",a.filename);a.on("close",function(){console.log("<-- %s",a.filename)})});var port=process.env.PORT||8080;server.listen(port,function(){console.log("Recording connections on port %s",port)});