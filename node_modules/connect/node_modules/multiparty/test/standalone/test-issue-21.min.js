var assert=require("assert");var http=require("http");var net=require("net");var multiparty=require("../../");var client;var server=http.createServer(function(c,a){var b=new multiparty.Form();b.parse(c,function(g,e,d,f,h){if(g){console.error(g.stack);return}assert.strictEqual(f.length,1);assert.strictEqual(f[0].name,"title");assert.strictEqual(f[0].value,"foofoo");assert.strictEqual(h.length,4);assert.strictEqual(h[0].fieldName,"upload");assert.strictEqual(h[1].fieldName,"upload");assert.strictEqual(h[2].fieldName,"upload");assert.strictEqual(h[3].fieldName,"upload");a.end();client.end();server.close()})});server.listen(function(){client=net.connect(server.address().port);client.write('POST /upload HTTP/1.1\r\nContent-Length: 728\r\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\n\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\nContent-Disposition: form-data; name="title"\r\n\r\nfoofoo\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\nContent-Disposition: form-data; name="upload"; filename="blah1.txt"\r\nContent-Type: text/plain\r\n\r\nhi1\r\n\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\nContent-Disposition: form-data; name="upload"; filename="blah2.txt"\r\nContent-Type: text/plain\r\n\r\nhi2\r\n\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\nContent-Disposition: form-data; name="upload"; filename="blah3.txt"\r\nContent-Type: text/plain\r\n\r\nhi3\r\n\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\nContent-Disposition: form-data; name="upload"; filename="blah4.txt"\r\nContent-Type: text/plain\r\n\r\nhi4\r\n\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF--\r\n')});