var assert=require("assert");var http=require("http");var net=require("net");var multiparty=require("../../");var client;var server=http.createServer(function(c,a){var b=new multiparty.Form({maxFields:1});b.on("aborted",function(){throw new Error("did not expect aborted")});var d=true;b.on("error",function(e){assert.ok(d);d=false;client.end();assert.ok(/maxFields/.test(e.message));server.close()});b.on("end",function(){throw new Error('Unexpected "end" event')});b.parse(c)});server.listen(function(){client=net.connect(server.address().port);client.write('POST /upload HTTP/1.1\r\nContent-Length: 728\r\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\n\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\nContent-Disposition: form-data; name="title"\r\n\r\nfoofoo\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\nContent-Disposition: form-data; name="upload"; filename="blah1.txt"\r\nContent-Type: text/plain\r\n\r\nhi1\r\n\r\n------WebKitFormBoundaryvfUZhxgsZDO7FXLF\r\n')});