var cookie=require("cookie");var parse=require("./lib/parse");module.exports=function cookieParser(a,c){return function b(h,d,e){if(h.cookies){return e()}var g=h.headers.cookie;h.secret=a;h.cookies={};h.signedCookies={};if(g){try{h.cookies=cookie.parse(g,c);if(a){h.signedCookies=parse.signedCookies(h.cookies,a);h.signedCookies=parse.JSONCookies(h.signedCookies)}h.cookies=parse.JSONCookies(h.cookies)}catch(f){f.status=400;return e(f)}}e()}};