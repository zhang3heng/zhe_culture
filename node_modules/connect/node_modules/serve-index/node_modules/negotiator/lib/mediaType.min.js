module.exports=preferredMediaTypes;preferredMediaTypes.preferredMediaTypes=preferredMediaTypes;function parseAccept(a){return a.split(",").map(function(b){return parseMediaType(b.trim())}).filter(function(b){return b})}function parseMediaType(e){var b=e.match(/\s*(\S+)\/([^;\s]+)\s*(?:;(.*))?/);if(!b){return null}var d=b[1],a=b[2],c=""+d+"/"+a,g={},f=1;if(b[3]){g=b[3].split(";").map(function(h){return h.trim().split("=")}).reduce(function(i,h){i[h[0]]=h[1];return i},g);if(g.q!=null){f=parseFloat(g.q);delete g.q}}return{type:d,subtype:a,params:g,q:f,full:c}}function getMediaTypePriority(a,b){return(b.map(function(c){return specify(a,c)}).filter(Boolean).sort(function(d,c){return d.s>c.s?-1:1})[0]||{q:0}).q}function specify(c,a){var e=parseMediaType(c);var b=0;if(a.type==e.type){b|=4}else{if(a.type!="*"){return null}}if(a.subtype==e.subtype){b|=2}else{if(a.subtype!="*"){return null}}var d=Object.keys(a.params);if(d.length>0){if(d.every(function(f){return a.params[f]=="*"||a.params[f]==e.params[f]})){b|=1}else{return null}}return{q:a.q,s:b,}}function preferredMediaTypes(b,a){b=parseAccept(b||"");if(a){return a.map(function(c){return[c,getMediaTypePriority(c,b)]}).filter(function(c){return c[1]>0}).sort(function(d,c){return d[1]===c[1]?0:d[1]>c[1]?-1:1}).map(function(c){return c[0]})}else{return b.sort(function(d,c){return d.q<c.q?1:-1}).filter(function(c){return c.q>0}).map(function(c){return c.full})}};