module.exports=preferredCharsets;preferredCharsets.preferredCharsets=preferredCharsets;function parseAcceptCharset(a){return a.split(",").map(function(b){return parseCharset(b.trim())}).filter(function(b){return b})}function parseCharset(c){var a=c.match(/^\s*(\S+?)\s*(?:;(.*))?$/);if(!a){return null}var g=a[1];var d=1;if(a[2]){var f=a[2].split(";");for(var b=0;b<f.length;b++){var e=f[b].trim().split("=");if(e[0]==="q"){d=parseFloat(e[1]);break}}}return{charset:g,q:d}}function getCharsetPriority(b,a){return(a.filter(function(c){return specify(b,c)}).sort(function(d,c){return d.s>c.s?-1:1})[0]||{q:0}).q}function specify(c,a){var b=0;if(a.charset===c){b|=1}else{if(a.charset!=="*"){return null}}return{s:b,q:a.q,}}function preferredCharsets(b,a){b=parseAcceptCharset(b||"");if(a){return a.map(function(c){return[c,getCharsetPriority(c,b)]}).filter(function(c){return c[1]>0}).sort(function(d,c){return d[1]>c[1]?-1:1}).map(function(c){return c[0]})}else{return b.sort(function(d,c){return d.q<c.q?1:-1}).filter(function(c){return c.q>0}).map(function(c){return c.charset})}};