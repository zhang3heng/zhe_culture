var http=require("http");
/*
 * Connect - basicAuth
 * Copyright(c) 2010 Sencha Inc.
 * Copyright(c) 2011 TJ Holowaychuk
 * MIT Licensed
 */
module.exports=function basicAuth(d,a){var c,b;if("string"==typeof d){c=d;b=a;if("string"!=typeof b){throw new Error("password argument required")}a=arguments[2];d=function(e,f){return e==c&&f==b}}a=a||"Authorization Required";return function(m,l,i){var k=m.headers.authorization;if(m.user){return i()}if(!k){return unauthorized(l,a)}var h=k.split(" ");if(h.length!==2){return i(error(400))}var e=h[0],f=new Buffer(h[1],"base64").toString(),j=f.indexOf(":");if("Basic"!=e||j<0){return i(error(400))}var g=f.slice(0,j),n=f.slice(j+1);if(d.length>=3){d(g,n,function(p,o){if(p||!o){return unauthorized(l,a)}m.user=m.remoteUser=o;i()})}else{if(d(g,n)){m.user=m.remoteUser=g;i()}else{unauthorized(l,a)}}}};function unauthorized(b,a){b.statusCode=401;b.setHeader("WWW-Authenticate",'Basic realm="'+a+'"');b.end("Unauthorized")}function error(b,c){var a=new Error(c||http.STATUS_CODES[b]);a.status=b;return a};