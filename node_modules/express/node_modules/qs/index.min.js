var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;var indexOf=typeof Array.prototype.indexOf==="function"?function(a,b){return a.indexOf(b)}:function(a,c){for(var b=0;b<a.length;b++){if(a[b]===c){return b}}return -1};var isArray=Array.isArray||function(a){return toString.call(a)=="[object Array]"};var objectKeys=Object.keys||function(c){var a=[];for(var b in c){if(c.hasOwnProperty(b)){a.push(b)}}return a};var forEach=typeof Array.prototype.forEach==="function"?function(a,b){return a.forEach(b)}:function(a,c){for(var b=0;b<a.length;b++){c(a[b])}};var reduce=function(a,e,b){if(typeof a.reduce==="function"){return a.reduce(e,b)}var d=b;for(var c=0;c<a.length;c++){d=e(d,a[c])}return d};var isint=/^[0-9]+$/;function promote(d,c){if(d[c].length==0){return d[c]={}}var b={};for(var a in d[c]){if(hasOwnProperty.call(d[c],a)){b[a]=d[c][a]}}d[c]=b;return b}function parse(e,c,b,f){var a=e.shift();if(Object.getOwnPropertyDescriptor(Object.prototype,b)){return}if(!a){if(isArray(c[b])){c[b].push(f)}else{if("object"==typeof c[b]){c[b]=f}else{if("undefined"==typeof c[b]){c[b]=f}else{c[b]=[c[b],f]}}}}else{var d=c[b]=c[b]||[];if("]"==a){if(isArray(d)){if(""!=f){d.push(f)}}else{if("object"==typeof d){d[objectKeys(d).length]=f}else{d=c[b]=[c[b],f]}}}else{if(~indexOf(a,"]")){a=a.substr(0,a.length-1);if(!isint.test(a)&&isArray(d)){d=promote(c,b)}parse(e,d,a,f)}else{if(!isint.test(a)&&isArray(d)){d=promote(c,b)}parse(e,d,a,f)}}}}function merge(e,d,h){if(~indexOf(d,"]")){var g=d.split("["),a=g.length,f=a-1;parse(g,e,"base",h)}else{if(!isint.test(d)&&isArray(e.base)){var c={};for(var b in e.base){c[b]=e.base[b]}e.base=c}set(e.base,d,h)}return e}function compact(d){if("object"!=typeof d){return d}if(isArray(d)){var a=[];for(var c in d){if(hasOwnProperty.call(d,c)){a.push(d[c])}}return a}for(var b in d){d[b]=compact(d[b])}return d}function parseObject(b){var a={base:{}};forEach(objectKeys(b),function(c){merge(a,c,b[c])});return compact(a.base)}function parseString(b){var a=reduce(String(b).split("&"),function(c,g){var h=indexOf(g,"="),f=lastBraceInKey(g),d=g.substr(0,f||h),e=g.substr(f||h,g.length),e=e.substr(indexOf(e,"=")+1,e.length);if(""==d){d=g,e=""}if(""==d){return c}return merge(c,decode(d),decode(e))},{base:{}}).base;return compact(a)}exports.parse=function(a){if(null==a||""==a){return{}}return"object"==typeof a?parseObject(a):parseString(a)};var stringify=exports.stringify=function(b,a){if(isArray(b)){return stringifyArray(b,a)}else{if("[object Object]"==toString.call(b)){return stringifyObject(b,a)}else{if("string"==typeof b){return stringifyString(b,a)}else{return a+"="+encodeURIComponent(String(b))}}}};function stringifyString(b,a){if(!a){throw new TypeError("stringify expects an object")}return a+"="+encodeURIComponent(b)}function stringifyArray(a,d){var b=[];if(!d){throw new TypeError("stringify expects an object")}for(var c=0;c<a.length;c++){b.push(stringify(a[c],d+"["+c+"]"))}return b.join("&")}function stringifyObject(g,f){var b=[],e=objectKeys(g),d;for(var c=0,a=e.length;c<a;++c){d=e[c];if(""==d){continue}if(null==g[d]){b.push(encodeURIComponent(d)+"=")}else{b.push(stringify(g[d],f?f+"["+encodeURIComponent(d)+"]":encodeURIComponent(d)))}}return b.join("&")}function set(c,b,d){var a=c[b];if(Object.getOwnPropertyDescriptor(Object.prototype,b)){return}if(undefined===a){c[b]=d}else{if(isArray(a)){a.push(d)}else{c[b]=[a,d]}}}function lastBraceInKey(e){var a=e.length,d,f;for(var b=0;b<a;++b){f=e[b];if("]"==f){d=false}if("["==f){d=true}if("="==f&&!d){return b}}}function decode(b){try{return decodeURIComponent(b.replace(/\+/g," "))}catch(a){return b}};