var debug=require("debug")("express:router:route");var methods=require("methods");var utils=require("../utils");module.exports=Route;function Route(a){debug("new %s",a);this.path=a;this.stack=undefined;this.methods={}}Route.prototype._options=function(){return Object.keys(this.methods).map(function(a){return a.toUpperCase()})};Route.prototype.dispatch=function(g,e,c){var d=this;var h=g.method.toLowerCase();if(h==="head"&&!this.methods.head){h="get"}g.route=d;if(typeof this.stack==="function"){this.stack(g,e,c);return}var b=d.stack;if(!b){return c()}var a=0;(function f(j){if(j&&j==="route"){return c()}var i=b[a++];if(!i){return c(j)}if(i.method&&i.method!==h){return f(j)}var k=i.handle.length;if(j){if(k<4){return f(j)}try{i.handle(j,g,e,f)}catch(j){f(j)}return}if(k>3){return f()}try{i.handle(g,e,f)}catch(j){f(j)}})()};Route.prototype.all=function(){var a=this;var b=utils.flatten([].slice.call(arguments));b.forEach(function(d){if(typeof d!=="function"){var c={}.toString.call(d);var e="Route.all() requires callback functions but got a "+c;throw new Error(e)}if(!a.stack){a.stack=d}else{if(typeof a.stack==="function"){a.stack=[{handle:a.stack},{handle:d}]}else{a.stack.push({handle:d})}}});return a};methods.forEach(function(a){Route.prototype[a]=function(){var b=this;var c=utils.flatten([].slice.call(arguments));c.forEach(function(e){if(typeof e!=="function"){var d={}.toString.call(e);var f="Route."+a+"() requires callback functions but got a "+d;throw new Error(f)}debug("%s %s",a,b.path);if(!b.methods[a]){b.methods[a]=true}if(!b.stack){b.stack=[]}else{if(typeof b.stack==="function"){b.stack=[{handle:b.stack}]}}b.stack.push({method:a,handle:e})});return b}});