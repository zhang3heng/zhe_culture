var mysql=require("mysql"),Busboy=require("busboy");var pool=mysql.createPool({host:"localhost",database:"zhe",port:"3306",user:"root",password:""});exports.login=function(f,e){var c=null,a=null,g,d;var b=new Busboy({headers:f.headers});b.on("field",function(h,i){if(h==="userName"){g=i}else{if(h=="userPsd"){d=i}}});b.on("finish",function(){var h=false;pool.getConnection(function(i,j){j.query("select * from user where name=? and password=?",[g,d],function(k,l){if(l.length>0){h=true}j.release();e.json(h)})})});return f.pipe(b)};exports.userReg=function(d,c){var e,b;var a=new Busboy({headers:d.headers});var f=false;a.on("field",function(g,h){if(g==="userName"){e=h}else{if(g=="userPsd"){b=h}}});a.on("finish",function(){var g="insert into user values (null,?,?,1)";pool.getConnection(function(h,i){i.query(g,[e,b],function(k,j){console.log(j);if(j.affectedRows){f=true}i.release();c.end(f)})})});return d.pipe(a)};